apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "k8s-chat.fullname" . }}-config
  labels:
    {{- include "k8s-chat.labels" . | nindent 4 }}
data:
  config.yaml: |
    # Goose Configuration for K8s Chat Container
    ANTHROPIC_HOST: https://api.anthropic.com
    GOOSE_PROVIDER: {{ .Values.goose.provider }}
    GOOSE_MODEL: {{ .Values.goose.model }}

    # Extensions configuration
    extensions:
      {{- if .Values.goose.extensions.developer }}
      developer:
        enabled: true
        type: builtin
        name: developer
        description: Code editing and shell access - includes kubectl for Kubernetes operations
        display_name: Developer Tools
        timeout: 300
        bundled: true
        available_tools: []
      {{- end }}

      {{- if .Values.goose.extensions.chatrecall }}
      chatrecall:
        enabled: true
        type: platform
        name: chatrecall
        description: Search past conversations and load session summaries for contextual memory
        bundled: true
        available_tools: []
      {{- end }}

      {{- if .Values.goose.extensions.todo }}
      todo:
        enabled: true
        type: platform
        name: todo
        description: Task management for complex operations
        bundled: true
        available_tools: []
      {{- end }}

      {{- if .Values.goose.extensions.extensionmanager }}
      extensionmanager:
        enabled: true
        type: platform
        name: Extension Manager
        description: Discover and manage additional extensions
        bundled: true
        available_tools: []
      {{- end }}

      {{- if .Values.goose.extensions.computercontroller }}
      computercontroller:
        enabled: true
        type: builtin
        name: computercontroller
        description: File operations, web scraping, and automation tools
        display_name: Computer Controller
        timeout: 300
        bundled: true
        available_tools: []
      {{- end }}

    # Kubernetes specific settings
    kubernetes:
      # The container will inherit kubectl config from mounted volumes or service account
      default_namespace: default
